(()=>{"use strict";var e={115:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(521)),l=n(893),c={label:"Save",primary:!0,isDisabled:!1,onClick:function(){return i(void 0,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return e={pdf:l.pdfProps.isChecked||!1,txt:l.txtProps.isChecked||!1},a.default.setAdminSettingsValue(e),[4,a.default.acceptAdminSettings(e)];case 1:return n.sent(),(t=[]).push({type:"success",title:"Data is saved."}),[2,{newProps:r(r({},c),{isDisabled:!0}),actions:["show-toast","update-props","update-status"],toastProps:t}]}}))}))},size:"small"};t.default=c},627:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default={label:"Cancel",primary:!1,isDisabled:!1,onClick:function(){return{}},size:"small"}},893:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.pdfProps=t.txtProps=void 0;var o=i(n(115));t.txtProps={label:"TXT",title:"TXT",isChecked:!0,onChange:function(){t.txtProps.isChecked=!t.txtProps.isChecked;var e=t.txtProps.isChecked?"Plugin will convert to .txt format":"Plugin will not convert to .txt format";return{newProps:s,actions:["update-props","update-accept-button-props","show-toast"],toastProps:[{type:t.txtProps.isChecked?"success":"info",title:e}],acceptButtonProps:r(r({},o.default),{isDisabled:!1})}}},t.pdfProps={label:"PDF",title:"PDF",isChecked:!0,onChange:function(){t.pdfProps.isChecked=!t.pdfProps.isChecked;var e=t.pdfProps.isChecked?"Plugin will convert to .pdf format":"Plugin will not convert to .pdf format";return{newProps:s,actions:["update-props","update-accept-button-props","show-toast"],toastProps:[{type:t.pdfProps.isChecked?"success":"info",title:e}],acceptButtonProps:r(r({},o.default),{isDisabled:!1})}}};var s=[t.txtProps,t.pdfProps],a={header:"Select converted file formats:",element:"checkbox",elementProps:s};t.default=a},815:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.adminSettingsElements=void 0;var c=o(n(893)),u=l(n(115)),f=l(n(627)),p=l(n(521)),d=l(n(607));t.adminSettingsElements={type:"modal",groups:[c.default],withAcceptButton:!0,acceptButtonProps:u.default,cancelButtonProps:f.default,isLoading:!0,onLoad:function(){return s(void 0,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,p.default.fetchAdminSettingsValue()];case 1:return(e=n.sent())&&(c.pdfProps.isChecked=e.pdf,c.txtProps.isChecked=e.txt,t.adminSettingsElements.groups=[c.default]),t.adminSettingsElements.isLoading=!1,d.default.setAdminPluginSettings(t.adminSettingsElements),[2,!1]}}))}))}}},652:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertFileItem=void 0,t.convertFileItem={key:"convert-file-item",type:"Files",position:0,label:"Convert file",icon:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRF5z5FvWU-DjRHm8ankd_VwHEgpSSGRhVUiA&usqp=CAU",onClick:function(){},fileExt:[".docx",".xlsx"]}},521:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(652),l=s(n(607)),c=new function(){var e=this;this.userSettingsValue={fileName:"",formats:[],mockApi:!1,localStorage:!1},this.adminSettingsValue={pdf:!0,txt:!0},this.acceptFromModalSettings=!1,this.currentFileId=null,this.apiURL="",this.setAcceptFromModalSettings=function(t){e.acceptFromModalSettings=t},this.setCurrentFileId=function(t){e.currentFileId=t},this.setUserSettingsValue=function(t){e.userSettingsValue=t,a.convertFileItem.fileExt=t.formats,l.default.updateContextMenuItem(a.convertFileItem)},this.getUserSettingsValue=function(){return e.userSettingsValue},this.setAdminSettingsValue=function(t){e.adminSettingsValue=t},this.getAdminSettingsValue=function(){return e.adminSettingsValue},this.fetchUserSettingsValue=function(){return i(e,void 0,void 0,(function(){var e,t,n,i,s,a;return o(this,(function(o){switch(o.label){case 0:return this.apiURL||this.createAPIUrl(),[4,this.getUser()];case 1:return e=o.sent(),t=localStorage.getItem("".concat(e.id,"-new-file-name")),[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users")];case 2:return[4,o.sent().json()];case 3:return(n=o.sent()).length>0&&(i=n.find((function(t){return t.userId===e.id})))?(s=[],i.docx&&s.push(".docx"),i.xlsx&&s.push(".xlsx"),l.default.updateStatus("active"),this.setUserSettingsValue({fileName:i.fileName,formats:s,mockApi:i.mockApi,localStorage:i.localStorage}),[2,{fileName:i.fileName,formats:s,mockApi:i.mockApi,localStorage:i.localStorage}]):(a=!!t&&JSON.parse(t))?(l.default.updateStatus("active"),this.setUserSettingsValue(r({},a)),[2,a]):[2,null]}}))}))},this.fetchAdminSettingsValue=function(){return i(e,void 0,void 0,(function(){var e,t;return o(this,(function(n){switch(n.label){case 0:return this.apiURL||this.createAPIUrl(),[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users")];case 1:return[4,n.sent().json()];case 2:return(e=n.sent()).length>0&&(t=e.find((function(e){return"general-settings"===e.userId})))?(this.setAdminSettingsValue({pdf:t.pdf,txt:t.txt}),[2,{pdf:t.pdf,txt:t.txt}]):[2,null]}}))}))},this.onLoad=function(){return i(e,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=[this.fetchUserSettingsValue(),this.fetchAdminSettingsValue()],[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},this.setAPIUrl=function(t){e.apiURL=t},this.createAPIUrl=function(){var t=l.default.getAPI();e.apiURL=t.origin.replace(/\/+$/,""),[t.proxy,t.prefix].forEach((function(t){if(t){var n=t.trim().replace(/^\/+/,"");e.apiURL+=n?e.apiURL.length>0&&"/"===e.apiURL[e.apiURL.length-1]?n:"/".concat(n):""}}))},this.getAPIUrl=function(){return e.apiURL},this.onConvertFileClick=function(t){return i(e,void 0,void 0,(function(){var e,n,r,i,s,a,c,u,f;return o(this,(function(o){switch(o.label){case 0:return this.setCurrentFileId(null),this.setAcceptFromModalSettings(!1),e=l.default.getStatus(),this.adminSettingsValue.pdf||this.adminSettingsValue.txt?"pending"!==e&&"hide"!==e&&this.userSettingsValue.fileName?[4,fetch("".concat(this.apiURL,"/files/file/").concat(t))]:(n={actions:["show-settings-modal"]},this.setAcceptFromModalSettings(!0),this.setCurrentFileId(t),[2,n]):[2,{actions:["show-toast"],toastProps:[{type:"warning",title:"DocSpace admin or DocSpace owner need enter settings"}]}];case 1:return[4,o.sent().json()];case 2:return r=o.sent().response,i=r.webUrl,s=r.folderId,a=r.fileExst,this.userSettingsValue.formats.includes(a)?((u=new URL("".concat(this.apiURL,"/filehandler.ashx"))).searchParams.append("action","create"),u.searchParams.append("fileuri",i),u.searchParams.append("folderid",s),u.searchParams.append("response","message"),f=[],this.adminSettingsValue.pdf&&(u.searchParams.append("title","".concat(this.userSettingsValue.fileName).concat(".pdf")),f.push(fetch(u.toString()))),this.adminSettingsValue.txt&&(u.searchParams.set("title","".concat(this.userSettingsValue.fileName).concat(".txt")),f.push(fetch(u.toString()))),[4,Promise.all(f)]):(c={actions:["show-settings-modal"]},this.setAcceptFromModalSettings(!0),this.setCurrentFileId(t),[2,c]);case 3:return o.sent(),[2,{actions:["show-toast"],toastProps:[{type:"success",title:this.adminSettingsValue.pdf&&this.adminSettingsValue.txt?"Files were created":this.adminSettingsValue.pdf?'File "'.concat(this.userSettingsValue.fileName).concat(".pdf",'" was created'):'File "'.concat(this.userSettingsValue.fileName).concat(".txt",'" was created')}]}]}}))}))},this.getUser=function(){return i(e,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,fetch("".concat(this.apiURL,"/people/@self"))];case 1:return[4,e.sent().json()];case 2:return[2,e.sent().response]}}))}))},this.acceptUserSettings=function(t){return i(e,void 0,void 0,(function(){var e,n,r,i,s;return o(this,(function(o){switch(o.label){case 0:return this.apiURL||this.createAPIUrl(),l.default.updateStatus("active"),e=null,this.acceptFromModalSettings&&this.currentFileId?[4,this.onConvertFileClick(this.currentFileId)]:[3,2];case 1:e=o.sent(),o.label=2;case 2:return t.localStorage||t.mockApi?[4,this.getUser()]:[2,e];case 3:return n=o.sent(),t.localStorage?(r=JSON.stringify(t),localStorage.setItem("".concat(n.id,"-new-file-name"),r)):localStorage.removeItem("".concat(n.id,"-new-file-name")),t.mockApi?[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify({userId:n.id,fileName:t.fileName,docx:t.formats.includes(".docx"),xlsx:t.formats.includes(".xlsx"),localStorage:t.localStorage,mockApi:t.mockApi})})]:[3,5];case 4:return o.sent(),[3,9];case 5:return[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users")];case 6:return[4,o.sent().json()];case 7:return(i=o.sent()).length>0?(s=i.find((function(e){return e.userId===n.id})).id,[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users/".concat(s),{method:"DELETE"})]):[3,9];case 8:o.sent(),o.label=9;case 9:return[2,e]}}))}))},this.acceptAdminSettings=function(t){return i(e,void 0,void 0,(function(){var e,n;return o(this,(function(i){switch(i.label){case 0:return this.apiURL||this.createAPIUrl(),[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users")];case 1:return[4,i.sent().json()];case 2:return(e=i.sent()).length>0&&(n=e.find((function(e){return"general-settings"===e.userId})))?[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users/".concat(n.id),{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r(r({},n),{pdf:t.pdf,txt:t.txt}))})]:[3,4];case 3:case 5:return i.sent(),[2];case 4:return[4,fetch("https://64a67577096b3f0fcc7fd1f7.mockapi.io/users",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r({userId:"general-settings"},t))})]}}))}))}};t.default=c},988:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getIsDisabled=void 0;var a=n(357),l=n(420),c=n(378),u=s(n(521));t.getIsDisabled=function(e,t,n){return!e||!t&&!n};var f={label:"Save",primary:!0,isDisabled:(0,t.getIsDisabled)(a.fileNameProps.value||"",(null===l.docxProps||void 0===l.docxProps?void 0:l.docxProps.isChecked)||!1,(null===l.xlsxProps||void 0===l.xlsxProps?void 0:l.xlsxProps.isChecked)||!1),onClick:function(){return i(void 0,void 0,void 0,(function(){var e,t,n,i,s,p,d;return o(this,(function(o){switch(o.label){case 0:return e=a.fileNameProps.value,t=[],(null===l.docxProps||void 0===l.docxProps?void 0:l.docxProps.isChecked)&&t.push(".docx"),(null===l.xlsxProps||void 0===l.xlsxProps?void 0:l.xlsxProps.isChecked)&&t.push(".xlsx"),n=null===c.localStorageProps||void 0===c.localStorageProps?void 0:c.localStorageProps.isChecked,i=null===c.mockApiStorageProps||void 0===c.mockApiStorageProps?void 0:c.mockApiStorageProps.isChecked,s={fileName:e||"",formats:t,mockApi:i||!1,localStorage:n||!1},u.default.setUserSettingsValue(r({},s)),[4,u.default.acceptUserSettings(r({},s))];case 1:return p=o.sent(),d=[],(null==p?void 0:p.toastProps)&&(d.push({type:"success",title:"Data is saved. Now you can use plugin"}),d.push.apply(d,p.toastProps)),[2,{newProps:r(r({},f),{isDisabled:!0}),actions:["show-toast","update-status","update-props"],toastProps:d}]}}))}))},size:"small"};t.default=f},685:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(521)),o={label:"Cancel",primary:!1,isDisabled:!1,onClick:function(){return i.default.setAcceptFromModalSettings(!1),i.default.setCurrentFileId(null),{}},size:"small"};t.default=o},420:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.xlsxProps=t.docxProps=void 0;var a=s(n(988)),l=n(357);t.docxProps={label:"DOCX",title:"DOCX",isChecked:!0,onChange:function(){t.docxProps.isChecked=!t.docxProps.isChecked;var e=t.docxProps.isChecked?"Plugin will show up for .docx files":"Plugin will not show up for .docx files";return{newProps:c,actions:["update-props","update-accept-button-props","show-toast"],toastProps:[{type:t.docxProps.isChecked?"success":"info",title:e}],acceptButtonProps:r(r({},a.default),{isDisabled:(0,a.getIsDisabled)(l.fileNameProps.value||"",t.docxProps.isChecked,(null===t.xlsxProps||void 0===t.xlsxProps?void 0:t.xlsxProps.isChecked)||!1)})}}},t.xlsxProps={label:"XLSX",title:"XLSX",isChecked:!0,onChange:function(){t.xlsxProps.isChecked=!t.xlsxProps.isChecked;var e=t.xlsxProps.isChecked?"Plugin will show up for .xlsx files":"Plugin will not show up for .xlsx files";return{newProps:c,actions:["update-props","update-accept-button-props","show-toast"],toastProps:[{type:t.xlsxProps.isChecked?"success":"info",title:e}],acceptButtonProps:r(r({},a.default),{isDisabled:(0,a.getIsDisabled)(l.fileNameProps.value||"",(null===t.docxProps||void 0===t.docxProps?void 0:t.docxProps.isChecked)||!1,t.xlsxProps.isChecked)})}}};var c=[t.docxProps,t.xlsxProps],u={header:"Select file formats:",element:"checkbox",elementProps:c};t.default=u},357:function(e,t,n){var r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)},i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.fileNameGroup=t.fileNameProps=void 0;var a=s(n(988)),l=n(420);t.fileNameProps={placeholder:"Enter new file name",scale:!0,isDisabled:!1,onChange:function(e){return t.fileNameProps.value=e,{newProps:r(r({},t.fileNameProps),{value:e}),actions:["update-props","update-accept-button-props"],acceptButtonProps:r(r({},a.default),{isDisabled:(0,a.getIsDisabled)(e,l.docxProps.isChecked||!1,(null===l.xlsxProps||void 0===l.xlsxProps?void 0:l.xlsxProps.isChecked)||!1)})}},value:""},t.fileNameGroup={header:"File name",element:"input",elementProps:t.fileNameProps};var c=[t.fileNameGroup];t.default=c},378:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mockApiStorageProps=t.localStorageProps=void 0,t.localStorageProps={isChecked:!1,label:"Local storage",onChange:function(){t.localStorageProps.isChecked=!t.localStorageProps.isChecked;var e=t.localStorageProps.isChecked?"Plugin will save info at local storage":"Plugin will not save info at local storage";return{newProps:n,actions:["update-props","show-toast"],toastProps:[{type:t.localStorageProps.isChecked?"success":"info",title:e}]}}},t.mockApiStorageProps={isChecked:!1,label:"Mock api storage",onChange:function(){t.mockApiStorageProps.isChecked=!t.mockApiStorageProps.isChecked;var e=t.mockApiStorageProps.isChecked?"Plugin will save info at mock api":"Plugin will not save info at mock api";return{newProps:n,actions:["update-props","show-toast"],toastProps:[{type:t.mockApiStorageProps.isChecked?"success":"info",title:e}]}}};var n=[t.localStorageProps,t.mockApiStorageProps],r={header:"Save info",element:"toggle-button",elementProps:n};t.default=r},582:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},l=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.settingsElements=void 0;var u=o(n(357)),f=o(n(420)),p=o(n(378)),d=c(n(988)),h=c(n(685)),g=c(n(521)),v=c(n(607));t.settingsElements={type:"both",groups:l(l([],u.default,!0),[f.default,p.default],!1),withAcceptButton:!0,acceptButtonProps:d.default,cancelButtonProps:h.default,isLoading:!0,onLoad:function(){return s(void 0,void 0,void 0,(function(){var e;return a(this,(function(n){switch(n.label){case 0:return[4,g.default.fetchUserSettingsValue()];case 1:return(e=n.sent())&&(u.fileNameProps.value=e.fileName,f.docxProps.isChecked=e.formats.includes(".docx"),f.xlsxProps.isChecked=e.formats.includes(".xlsx"),p.localStorageProps.isChecked=e.localStorage,p.mockApiStorageProps.isChecked=e.mockApi,t.settingsElements.groups=l(l([],u.default,!0),[f.default,p.default],!1)),t.settingsElements.isLoading=!1,v.default.setUserPluginSettings(t.settingsElements),[2,!1]}}))}))}}},607:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function a(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}l((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(582),a=n(652),l=o(n(521)),c=n(815),u=new function(){var e=this;this.status="pending",this.userPluginSettings={},this.adminPluginSettings={},this.origin="",this.proxy="",this.prefix="",this.contextMenuItems=new Map,this.onLoadCallback=function(){return r(e,void 0,void 0,(function(){return i(this,(function(e){return[2]}))}))},this.updateStatus=function(t){e.status=t},this.getStatus=function(){return e.status},this.setOnLoadCallback=function(t){e.onLoadCallback=t},this.getUserPluginSettings=function(){return e.userPluginSettings},this.setUserPluginSettings=function(t){e.userPluginSettings=t},this.getAdminPluginSettings=function(){return e.adminPluginSettings},this.setAdminPluginSettings=function(t){e.adminPluginSettings=t},this.setOrigin=function(t){e.origin=t},this.getOrigin=function(){return e.origin},this.setProxy=function(t){e.proxy=t},this.getProxy=function(){return e.proxy},this.setPrefix=function(t){e.prefix=t},this.getPrefix=function(){return e.prefix},this.setAPI=function(t,n,r){e.origin=t,e.proxy=n,e.prefix=r},this.getAPI=function(){return{origin:e.origin,proxy:e.proxy,prefix:e.prefix}},this.addContextMenuItem=function(t){e.contextMenuItems.set(t.key,t)},this.getContextMenuItemsKeys=function(){return Array.from(e.contextMenuItems).map((function(e){var t=e[0];return e[1],t}))},this.getContextMenuItems=function(){return e.contextMenuItems},this.updateContextMenuItem=function(t){e.contextMenuItems.set(t.key,t)}};u.setUserPluginSettings(s.settingsElements),u.setAdminPluginSettings(c.adminSettingsElements),a.convertFileItem.onClick=l.default.onConvertFileClick,u.addContextMenuItem(a.convertFileItem),u.setOnLoadCallback(l.default.onLoad),window.Plugins.ConvertFilePlugin=u||{},t.default=u}},t={};!function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r].call(o.exports,o,o.exports,n),o.exports}(607)})();